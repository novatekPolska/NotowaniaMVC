!function(a){a.fn.AjaxModal=function(o){function t(){a(".AjaxModal-overlay, #ajax-modal").fadeOut(n.fadeOutDuration,function(){a(".AjaxModal-overlay").remove(),a("#ajax-modal").empty()})}function i(o,t){var i="",d="AjaxModal-nobg";t&&(i=t),"always"==n.showTitlebar?d="":"whenAvailable"==n.showTitlebar?t&&(d=""):d="",a("#ajax-modal").html('<div class="AjaxModal-top '+d+'">'+i+'<span class="AjaxModal-close">'+n.closeButton+'</div></div><div class="AjaxModal-content">'+o+"</div>").css("width",n.modalWidth).fadeIn(n.fadeInDuration),a("body").append('<div class="AjaxModal-overlay"></div>'),a(".AjaxModal-overlay").css("opacity",n.overlayOpacity).hide().fadeIn(n.fadeInDuration)}function d(){a("body").append('<div class="AjaxModal-modal" id="ajax-modal"></div>'),a("#ajax-modal").hide()}function l(o,t,d,l){a.ajax({url:t,type:o,data:d,crossDomain:!0,cache:n.caching,success:function(a){i(a,l)}})}d();var n=a.extend({modalWidth:"50%",fadeInDuration:300,fadeOutDuration:300,overlayOpacity:.3,closeButton:"&times;",dismissable:!0,showTitlebar:"always",caching:!1},o);this.bind("click.AjaxModal",function(o){var t=a(this.form);return t.length?l(t.attr("method"),t.attr("action"),t.serialize(),a(this).data("title")):l("GET",a(this).attr("href"),null,a(this).data("title")),!1}),a("body").on("click",".AjaxModal-close",function(){t()}),a("body").on("click",".AjaxModal-overlay",function(){n.dismissable&&t()}),a(document).keyup(function(a){27==a.keyCode&&n.dismissable&&t()})}}(jQuery);